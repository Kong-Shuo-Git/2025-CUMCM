# 2025数学建模竞赛 - 模型代码

本项目包含2025年全国大学生数学建模竞赛的解决方案代码，主要涉及碳化硅外延层厚度的红外多光束干涉分析。

## 项目结构

```
├── Problem2_solution.py          # 问题2主解决方案
├── Problem2_灵敏度单独.py         # 问题2灵敏度分析
├── Problem3_solution.py          # 问题3主解决方案  
├── Problem3_灵敏度单独.py         # 问题3灵敏度分析
├── Problem4_solution.py          # 问题4主解决方案
├── Problem4_灵敏度分析.py         # 问题4灵敏度分析
├── 附件1_processed.xlsx          # 处理后的附件1数据
├── 附件2_processed.xlsx          # 处理后的附件2数据
├── 附件3.xlsx                    # 附件3原始数据
├── 附件3_processed.xlsx          # 处理后的附件3数据
├── 附件4.xlsx                    # 附件4原始数据
├── 附件4_processed.xlsx          # 处理后的附件4数据
├── 代码.pdf                      # 代码说明文档
├── 对碳化硅外延层厚度的红外多光束干涉分析.docx  # 技术分析报告
├── README.md                     # 项目说明文档
└── requirements.txt              # Python依赖包列表
```

## 环境要求

- Python 3.7+
- 推荐使用Anaconda环境

## 安装依赖

```bash
pip install -r requirements.txt
```

## 主要功能模块

### 问题2 - 碳化硅外延层厚度分析
- **主解决方案** (`Problem2_solution.py`): 基于Cauchy和Sellmeier折射率模型的厚度计算
- **灵敏度分析** (`Problem2_灵敏度单独.py`): 参数变化对厚度计算结果的敏感性分析

**核心算法**:
- 多光束干涉极值点检测
- Cauchy折射率模型: `n = A + B/λ² + C/λ⁴`
- Sellmeier折射率模型: `n² = 1 + A₁λ²/(λ² - B₁)`
- 厚度计算公式: `d = kλ/(2n·cosθ)`

### 问题3 - 硅外延层厚度分析
- **主解决方案** (`Problem3_solution.py`): 多光束干涉反射率拟合模型
- **灵敏度分析** (`Problem3_灵敏度单独.py`): 拟合参数对厚度精度的影响

**核心算法**:
- 自动干涉区间选择
- 多光束艾里反射率公式拟合
- 虚拟峰生成增强拟合稳定性
- 斯涅尔定律光路计算

### 问题4 - SiC多波束干涉综合分析
- **主解决方案** (`Problem4_solution.py`): 基于GB/T 42905-2023标准的厚度计算
- **灵敏度分析** (`Problem4_灵敏度分析.py`): 入射角变化对厚度测量的影响

**核心算法**:
- 多波束极值点检测
- 标准化厚度计算流程
- 入射角-厚度灵敏度分析

## 数据文件说明

### 输入数据
- **附件1/2**: 碳化硅样品红外反射光谱数据（波数vs反射率）
- **附件3/4**: 硅样品红外反射光谱数据

### 输出结果
运行代码后，将在`output/`目录下生成：
- `images/`: 可视化图表
- `excel/`: 计算结果表格
- `txt/`: 分析报告文本
- `stability/`: 稳定性分析结果
- `灵敏度分析/`: 灵敏度分析专题结果

## 使用方法

### 运行单个问题解决方案
```bash
# 问题2
python Problem2_solution.py
python Problem2_灵敏度单独.py

# 问题3  
python Problem3_solution.py
python Problem3_灵敏度单独.py

# 问题4
python Problem4_solution.py
python Problem4_灵敏度分析.py
```

### 批量运行
```bash
# 运行所有主解决方案
for file in Problem*_solution.py; do python "$file"; done

# 运行所有灵敏度分析
for file in Problem*灵敏度*.py; do python "$file"; done
```

## 技术特点

### 物理模型
- 严格遵循红外反射法物理原理
- 符合GB/T 42905-2023国家标准
- 支持多种折射率模型（Cauchy、Sellmeier、经验模型）

### 算法优化
- 自动极值点检测与过滤
- 异常值识别与剔除
- 多区间加权厚度计算
- 高精度数值拟合（容差1e-15）

### 可视化功能
- 光谱曲线与极值点标注
- 厚度分布直方图
- 残差分析图表
- 灵敏度分析曲线

## 关键参数

### 材料参数
- **SiC**: 折射率 n = 2.55
- **Si**: 折射率 n = 3.40
- **GaAs**: 折射率 n = 3.30

### 计算参数
- 有效波长范围: 2500-5000nm
- 厚度范围: 0.1-100μm（SiC）、3-200μm（标准）
- RSD精度要求: ≤1%（单实验室）、≤2%（多实验室）

## 注意事项

1. **数据格式**: 输入文件需为Excel格式，包含波数(cm⁻¹)和反射率(%)两列
2. **波长范围**: 确保数据覆盖2500-5000nm有效区间
3. **数据质量**: 有效数据点建议≥50个以保证计算精度
4. **内存使用**: 大量数据处理时注意内存占用，建议分批处理

## 结果解释

### 厚度计算结果
- **平均厚度**: 多极值点厚度的算术平均值
- **标准差**: 厚度分布的离散程度
- **RSD**: 相对标准偏差，衡量测量精度

### 灵敏度分析结果
- **参数敏感性**: 各参数变化对厚度结果的影响程度
- **稳定性评估**: 不同条件下计算结果的稳定性
- **误差传播**: 测量误差在计算中的传递规律

## 技术支持

如遇到问题，请检查：
1. Python环境和依赖包是否正确安装
2. 输入数据文件格式和路径是否正确
3. 输出目录权限是否充足

## 参考文献

1. GB/T 42905-2023 红外反射法测量半导体外延层厚度方法
2. 碳化硅材料光学常数手册
3. 多光束干涉理论与应用
4. 数学建模算法与应用

---

**版权声明**: 本代码仅用于2025年全国大学生数学建模竞赛，请勿用于商业用途。